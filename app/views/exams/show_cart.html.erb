<% content_for(:title, "Shopping Cart") %>

<% if @exams.size > 0 %>
  <%= rsna_table_for @exams, class: "table table-bordered table-striped" do |st| %>
    <% st.column("Accession #") {|e| h e.accession_number } %>
    <% st.column("Exam Desc") {|e| h e.exam_description } %>
    <% st.column("Exam Date") {|e| h e.modified_date.to_s(:long) } %>
    <% st.column("") {|e| button_to("Remove From Cart", "#", id: "delete_link_#{e.id}", class: "btn btn-primary", onclick: "delete_from_cart('delete_link_#{e.id}', '#{e.id}');return false;") } %>
  <% end %>

<div>
  <%= link_to("Empty Cart", {action: "empty_cart", controller: "exams"}, class: "btn btn-primary") %>
  <%= link_to("Send Cart", "#", class: "btn btn-primary", onclick: "$('#token-modal').modal('toggle'); return false;") %>
</div>

<%= render partial: "exams/token_dialog", locals: {exams: @exams} %>

<% else %>
 <div>Your shopping cart is empty</div>
<% end %>

<%= javascript_tag do %>
$(document).ready(function() {
  $(".use-old-button").click(function(e) {
    $("#tokenChoiceDialog").hide();
    if ($(this).val() == "Yes") {
      $("#cart_form").append('<input type="hidden" name="use_old" value="true" />');
      $('#tokenPasswordDialog input[name="patient_password"]').val("not-used-password1");
      $('#tokenPasswordDialog input[name="patient_password_confirmation"]').val("not-used-password1");
      $("#tokenSendDialog").show();
    } else {
      $("#tokenPasswordDialog").show();
    }

  });
});
<% end %>
